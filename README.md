# Hospital API Management System

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
Hospital API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö Authentication ‡πÅ‡∏•‡∏∞ Authorization ‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ Go ‡πÅ‡∏•‡∏∞ PostgreSQL ‡πÉ‡∏ä‡πâ architecture ‡πÅ‡∏ö‡∏ö Clean Code ‡πÅ‡∏•‡∏∞ Type-Safe Models

## ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å
- üè• **Hospital Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏° relationship
- üë®‚Äç‚öïÔ∏è **Staff Authentication** - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ JWT
- üîç **Advanced Patient Search** - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö multi-field ‡∏î‡πâ‡∏ß‡∏¢ query parameters
- üõ°Ô∏è **Type-Safe JWT Claims** - JWT authentication ‡∏î‡πâ‡∏ß‡∏¢ structured claims
- üåç **Multilingual Support** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- üìä **GORM ORM** - Auto migration ‡πÅ‡∏•‡∏∞ type-safe database operations
- üîó **Foreign Key Relationships** - Hospital ‚Üî Staff ‚Üî Patient
- üê≥ **Docker Ready** - Docker Compose ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö development ‡πÅ‡∏•‡∏∞ production
- üìù **Structured API Models** - Type-safe request/response models

## ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
- **Go 1.22+** - Core programming language
- **Gin Framework** - HTTP router ‡∏û‡∏£‡πâ‡∏≠‡∏° middleware ‡πÅ‡∏•‡∏∞ route grouping
- **GORM** - ORM ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö database operations
- **PostgreSQL** - Primary database with foreign key constraints
- **JWT (golang-jwt/jwt/v5)** - Structured authentication claims
- **bcrypt** - Secure password hashing
- **Docker & Docker Compose** - Containerization ‡πÅ‡∏•‡∏∞ development environment

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ (Clean Architecture)
```
hospital-api/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ main.go                    # Application entry point
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ envs.go               # Environment configuration
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router.go             # Route grouping & middleware setup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staff.go              # Staff endpoints (create, login)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ patient.go            # Patient endpoints (search)
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.go               # JWT authentication middleware
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.go                # Structured API request/response models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hospital.go           # Hospital domain model
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.go               # Staff & Patient domain models
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ auth.go               # JWT generation & validation
‚îÇ       ‚îú‚îÄ‚îÄ staff.go              # Staff business logic
‚îÇ       ‚îî‚îÄ‚îÄ painet.go             # Patient business logic
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ db.go                     # GORM connection & auto migration
‚îÇ   ‚îî‚îÄ‚îÄ seed.go                   # Mock data seeding
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf                # Nginx reverse proxy configuration
‚îú‚îÄ‚îÄ Dockerfile                    # Multi-stage Docker build
‚îú‚îÄ‚îÄ compose.yaml                  # Docker Compose setup
‚îú‚îÄ‚îÄ .env.example                  # Environment template
‚îî‚îÄ‚îÄ README.md
```

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô

### 1. Clone Repository
```bash
git clone https://github.com/chisanucha-plum/hospital-api.git
cd hospital-api
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
```bash
# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå environment template
cp .env.example .env

# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏ô .env ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
# JWT_SECRET=your-secret-key-here
# DB_HOST=postgres_server
# DB_USER=postgres
# DB_PASSWORD=password
# DB_NAME=hospital_db
```

### 3. ‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Docker Compose (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
```bash
# Build ‡πÅ‡∏•‡∏∞ start ‡∏ó‡∏∏‡∏Å service
docker-compose up --build

# ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡πÉ‡∏ô background
docker-compose up -d --build

# ‡∏î‡∏π logs
docker-compose logs -f

# ‡∏´‡∏¢‡∏∏‡∏î service
docker-compose down
```

### 4. ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö Local Development
```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
go mod download

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ PostgreSQL local ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç .env
# DB_HOST=localhost

# ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°
go run cmd/main.go
```

## API Endpoints

### üîê Staff Authentication

#### ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà (‡πÉ‡∏ä‡πâ hospital_name)
```http
POST /api/v1/staff/create
Content-Type: application/json

{
  "username": "admin123",
  "password": "securepassword",
  "hospital_name": "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä"
}
```

**Response:**
```json
{
  "success": true,
  "message": "Staff created successfully",
  "data": {
    "message": "Staff created successfully",
    "staff_id": 1
  }
}
```

#### ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
```http
POST /api/v1/staff/login
Content-Type: application/json

{
  "username": "admin123",
  "password": "securepassword"
}
```

**Response:**
```json
{
  "success": true,
  "message": "Login successful",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

### üè• Patient Management (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ JWT Token)

#### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ ID (National ID ‡∏´‡∏£‡∏∑‡∏≠ Passport)
```http
GET /api/v1/patients/search/{id}
Authorization: Bearer {JWT_TOKEN}
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```bash
GET /api/v1/patients/search/1234567890123
```

**Response:**
```json
{
  "success": true,
  "message": "Patient found",
  "data": {
    "national_id": "1234567890123",
    "patient_hn": "HN0001",
    "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
    "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ",
    "first_name_en": "Somchai",
    "last_name_en": "Jaidee",
    "date_of_birth": "1990-01-01T00:00:00Z",
    "passport_id": "",
    "phone_number": "0812345678",
    "email": "somchai@example.com",
    "gender": "M",
    "hospital_id": 1
  }
}
```

#### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö Multi-field (Query Parameters)
```http
GET /api/v1/patients/search?field=value&field2=value2
Authorization: Bearer {JWT_TOKEN}
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```bash
# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (partial match)
GET /api/v1/patients/search?first_name_th=‡∏™‡∏°‡∏ä‡∏≤‡∏¢

# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ (exact match)
GET /api/v1/patients/search?phone_number=0812345678

# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
GET /api/v1/patients/search?first_name_th=‡∏™‡∏°&last_name_th=‡πÉ‡∏à&email=som

# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ HN
GET /api/v1/patients/search?patient_hn=HN0001
```

**Response:**
```json
{
  "success": true,
  "message": "Patients found",
  "data": {
    "patients": [
      {
        "national_id": "1234567890123",
        "patient_hn": "HN0001",
        "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
        "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ"
        // ... other fields
      }
    ],
    "count": 1
  }
}
```

### Search Fields ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö

| Field | Type | Match Type | Description |
|-------|------|------------|-------------|
| `national_id` | string | Exact | ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô |
| `passport_id` | string | Exact | ‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á |
| `patient_hn` | string | Exact | Hospital Number |
| `phone_number` | string | Exact | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå |
| `first_name_th` | string | Partial | ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ |
| `last_name_th` | string | Partial | ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ |
| `first_name_en` | string | Partial | ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© |
| `last_name_en` | string | Partial | ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© |
| `email` | string | Partial | ‡∏≠‡∏µ‡πÄ‡∏°‡∏• |

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

### Mock Data ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Mock Data ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:

#### üè• **Hospitals (5 ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)**
1. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä (ID: 1)
2. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå (ID: 2) 
3. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏≤‡∏°‡∏≤‡∏ò‡∏¥‡∏ö‡∏î‡∏µ (ID: 3)
4. ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏ß‡∏ä‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô (ID: 4)
5. Bangkok Hospital (ID: 5)

#### üë®‚Äç‚öïÔ∏è **Staff Accounts (6 ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)**
| Username | Password | Hospital |
|----------|----------|----------|
| `admin_siriraj` | `password123` | ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä |
| `admin_chula` | `password123` | ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå |
| `admin_rama` | `password123` | ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏≤‡∏°‡∏≤‡∏ò‡∏¥‡∏ö‡∏î‡∏µ |
| `doctor_tropical` | `password123` | ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏ß‡∏ä‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô |
| `nurse_bangkok` | `password123` | Bangkok Hospital |
| `admin_siriraj2` | `password123` | ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä |

#### üè• **Patients (10 ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢)**
| National ID | Patient HN | Name (TH) | Name (EN) | Hospital |
|-------------|------------|-----------|-----------|----------|
| `1234567890123` | `HN0001` | ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ | Somchai Jaidee | ‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä |
| `2345678901234` | `HN0002` | ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° | Somying Suaynam | ‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä |
| `3456789012345` | `HN0003` | ‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å | Wichai Kengmak | ‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå |
| `4567890123456` | `HN0004` | ‡∏ß‡∏±‡∏ô‡∏ó‡∏ô‡∏≤ ‡∏£‡∏±‡∏Å‡∏î‡∏µ | Wantana Rakdee | ‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå |
| `5678901234567` | `HN0005` | ‡∏õ‡∏£‡∏∞‡∏û‡∏à‡∏ô‡πå ‡∏™‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå | Prapot Somprasong | ‡∏£‡∏≤‡∏°‡∏≤‡∏ò‡∏¥‡∏ö‡∏î‡∏µ |
| ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ... | | | | |

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Step-by-Step

#### 1. ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà (‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Mock Account)
```bash
# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà
curl -X POST "http://localhost:8002/api/v1/staff/create" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin123",
    "password": "mypassword",
    "hospital_name": "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏¥‡∏£‡∏¥‡∏£‡∏≤‡∏ä"
  }'

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ Mock Account (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
# Username: admin_siriraj, Password: password123
```

#### 2. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö JWT Token
```bash
# ‡πÉ‡∏ä‡πâ Mock Account
curl -X POST "http://localhost:8002/api/v1/staff/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin_siriraj",
    "password": "password123"
  }'
```

#### 3. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ National ID (‡πÉ‡∏ä‡πâ Mock Data)
```bash
# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ
curl -X GET "http://localhost:8002/api/v1/patients/search/1234567890123" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```

#### 4. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (Query Parameters)
```bash
# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
curl -X GET "http://localhost:8002/api/v1/patients/search?first_name_th=‡∏™‡∏°‡∏ä‡∏≤‡∏¢" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"

# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ Hospital Number
curl -X GET "http://localhost:8002/api/v1/patients/search?patient_hn=HN0001" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```

## Environment Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `PORT` | API server port | 8002 | No |
| `DB_HOST` | Database host | postgres_server | Yes |
| `DB_PORT` | Database port | 5432 | Yes |
| `DB_USER` | Database username | postgres | Yes |
| `DB_PASSWORD` | Database password | - | Yes |
| `DB_NAME` | Database name | hospital_db | Yes |
| `JWT_SECRET` | JWT signing secret (‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á) | - | Yes |

## Database Schema

### ERD (Entity Relationship Diagram)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Hospital     ‚îÇ       ‚îÇ      Staff      ‚îÇ       ‚îÇ     Patient     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îå‚îÄ‚îÄ‚Üí‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îå‚îÄ‚îÄ‚Üí‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (PK)         ‚îÇ   ‚îÇ   ‚îÇ id (PK)         ‚îÇ   ‚îÇ   ‚îÇ national_id(PK) ‚îÇ
‚îÇ name (unique)   ‚îÇ   ‚îÇ   ‚îÇ username        ‚îÇ   ‚îÇ   ‚îÇ patient_hn      ‚îÇ
‚îÇ created_at      ‚îÇ   ‚îÇ   ‚îÇ password (hash) ‚îÇ   ‚îÇ   ‚îÇ first_name_th   ‚îÇ
‚îÇ updated_at      ‚îÇ   ‚îÇ   ‚îÇ hospital_id(FK) ‚îÇ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ last_name_th    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ created_at      ‚îÇ       ‚îÇ first_name_en   ‚îÇ
                      ‚îÇ   ‚îÇ updated_at      ‚îÇ       ‚îÇ last_name_en    ‚îÇ
                      ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ date_of_birth   ‚îÇ
                      ‚îÇ                             ‚îÇ passport_id     ‚îÇ
                      ‚îÇ                             ‚îÇ phone_number    ‚îÇ
                      ‚îÇ                             ‚îÇ email           ‚îÇ
                      ‚îÇ                             ‚îÇ gender (M/F)    ‚îÇ
                      ‚îÇ                             ‚îÇ hospital_id(FK) ‚îÇ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ                             ‚îÇ created_at      ‚îÇ
                      ‚îÇ                             ‚îÇ updated_at      ‚îÇ
                      ‚îÇ                             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

### Primary Keys ‡πÅ‡∏•‡∏∞ Constraints
- **Hospital**: `id` (auto-increment), `name` (unique)
- **Staff**: `id` (auto-increment), `username` + `hospital_id` (unique)
- **Patient**: `national_id` (string PK), `patient_hn` + `hospital_id` (unique)
- **Gender**: Enum constraint (M, F ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
- **Foreign Keys**: Staff.hospital_id ‚Üí Hospital.id, Patient.hospital_id ‚Üí Hospital.id

## Type-Safe Models

### API Models (Structured)
```go
// Request Models
type CreateStaffRequest struct {
    Username     string `json:"username" binding:"required"`
    Password     string `json:"password" binding:"required"`
    HospitalName string `json:"hospital_name" binding:"required"`
}

type LoginRequest struct {
    Username string `json:"username" binding:"required"`
    Password string `json:"password" binding:"required"`
}

// Response Models
type APIResponse struct {
    Success bool        `json:"success"`
    Message string      `json:"message"`
    Data    interface{} `json:"data,omitempty"`
    Error   string      `json:"error,omitempty"`
}

// JWT Claims (Type-Safe)
type JWTClaims struct {
    StaffID    int `json:"staff_id"`
    HospitalID int `json:"hospital_id"`
    jwt.RegisteredClaims
}
```

## Architecture & Design Patterns

### Clean Architecture Layers
- **Handlers**: HTTP request/response handling
- **Services**: Business logic ‡πÅ‡∏•‡∏∞ data validation
- **Models**: Domain models ‡πÅ‡∏•‡∏∞ API models
- **Database**: GORM ORM ‡πÅ‡∏•‡∏∞ PostgreSQL

### Design Patterns ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
- **Dependency Injection**: ‡πÉ‡∏ä‡πâ `Depends()` pattern
- **Repository Pattern**: Service layer abstracts database operations
- **Factory Pattern**: NewService constructors
- **Middleware Pattern**: JWT authentication
- **Route Grouping**: API versioning ‡πÅ‡∏•‡∏∞ middleware organization

## ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤

### Local Development
```bash
# ‡∏î‡πâ‡∏ß‡∏¢ Docker Compose (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
docker-compose up --build

# Live reload ‡∏î‡πâ‡∏ß‡∏¢ air (‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß)
air

# ‡∏£‡∏±‡∏ô tests
go test ./...

# Format code
gofmt -w .
```

### Testing
```bash
# ‡∏£‡∏±‡∏ô unit tests ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
go test ./...

# Test ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ package
go test ./internal/services/
go test ./internal/handlers/

# Test ‡∏û‡∏£‡πâ‡∏≠‡∏° coverage
go test -cover ./...

# Verbose output
go test -v ./...
```

### Build Production
```bash
# Build binary
go build -o bin/hospital-api cmd/main.go

# Build Docker image
docker build -t hospital-api:latest .
```

## Docker Deployment

### Development Environment
```bash
# Start all services
docker-compose up --build

# View logs
docker-compose logs -f api

# Reset database
docker-compose down -v && docker-compose up --build
```

### Production Environment
```bash
# Build production image
docker build -t hospital-api:production .

# Run with production env
docker run -d \
  --name hospital-api-prod \
  -p 8002:8002 \
  --env-file .env.production \
  hospital-api:production
```

## Security & Best Practices

### üîê Security Features
- **Structured JWT Claims** - Type-safe authentication tokens
- **bcrypt Password Hashing** - Industry-standard password security
- **Foreign Key Constraints** - Data integrity enforcement
- **Input Validation** - Request model validation
- **SQL Injection Protection** - Parameterized queries ‡∏ú‡πà‡∏≤‡∏ô GORM
- **Hospital Isolation** - Data segregation ‡∏ï‡∏≤‡∏° hospital_id

### üìã Production Checklist
- [ ] ‡πÉ‡∏ä‡πâ HTTPS/TLS ‡πÉ‡∏ô production
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ CORS policy ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
- [ ] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô JWT_SECRET ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á (256-bit)
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ rate limiting ‡πÅ‡∏•‡∏∞ request throttling
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° structured logging ‡πÅ‡∏•‡∏∞ monitoring
- [ ] Database backup automation
- [ ] Health check endpoints
- [ ] Error tracking ‡πÅ‡∏•‡∏∞ alerting

## Performance Optimization

### Database Indexing
```sql
-- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö patient search performance
CREATE INDEX idx_patient_hospital_id ON user_patients(hospital_id);
CREATE INDEX idx_patient_names ON user_patients(first_name_th, last_name_th);
CREATE INDEX idx_patient_phone ON user_patients(phone_number);
CREATE INDEX idx_patient_email ON user_patients(email);
```

### Caching Strategy
- **JWT Token Caching**: In-memory token validation
- **Database Connection Pooling**: GORM connection pool
- **Query Result Caching**: Redis (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production)

### Monitoring Metrics
- Response time per endpoint
- Database query performance
- JWT token validation time
- Memory ‡πÅ‡∏•‡∏∞ CPU usage
- Error rate ‡πÅ‡∏•‡∏∞ status codes

## Contributing

### Code Style Guidelines
- ‡πÉ‡∏ä‡πâ `gofmt` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö formatting
- ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö camelCase
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô godoc comments ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö public functions
- ‡πÉ‡∏ä‡πâ structured logging
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô unit tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà

### Pull Request Process
1. Fork repository ‡∏ô‡∏µ‡πâ
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á feature branch (`git checkout -b feature/amazing-feature`)
3. Commit ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (`git commit -m 'Add amazing feature'`)
4. Push ‡πÑ‡∏õ‡∏¢‡∏±‡∏á branch (`git push origin feature/amazing-feature`)
5. ‡πÄ‡∏õ‡∏¥‡∏î Pull Request ‡∏û‡∏£‡πâ‡∏≠‡∏° description ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô

## Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

#### 1. "Connection refused" - ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ database
```bash
# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ PostgreSQL ‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
docker-compose ps

# restart database service
docker-compose restart postgres_server

# ‡∏î‡∏π logs ‡∏Ç‡∏≠‡∏á database
docker-compose logs postgres_server
```

#### 2. "Foreign key constraint" error
```bash
# ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞ migrate ‡πÉ‡∏´‡∏°‡πà
docker-compose down -v
docker-compose up --build

# ‡∏´‡∏£‡∏∑‡∏≠ reset ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ database
docker-compose exec postgres_server psql -U postgres -d hospital_db -c "DROP SCHEMA public CASCADE; CREATE SCHEMA public;"
```

#### 3. "JWT token invalid"
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ JWT_SECRET ‡πÉ‡∏ô .env ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ token ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Authorization header format: `Bearer <token>`

#### 4. "Hospital not found" error
```bash
# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ hospital ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
docker-compose exec postgres_server psql -U postgres -d hospital_db -c "SELECT * FROM hospitals;"

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà mock data
docker-compose exec api go run database/seed.go
```

## Version History

### v2.0.0 (Current)
- ‚úÖ Type-safe JWT claims structure
- ‚úÖ Structured API request/response models
- ‚úÖ Query parameters ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö patient search
- ‚úÖ Route grouping ‡πÅ‡∏•‡∏∞ API versioning
- ‚úÖ Enhanced error handling

### v1.0.0 (Previous)
- Basic CRUD operations
- JWT authentication
- Docker containerization
- GORM integration

---

## License
Copyright ¬© 2025 Hospital API Management System  
All rights reserved.

## Contact & Support
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
- **GitHub Issues**: [Create an issue](https://github.com/chisanucha-plum/hospital-api/issues)
- **Documentation**: [API Documentation](https://github.com/chisanucha-plum/hospital-api/wiki)

---
**Made with ‚ù§Ô∏è for Thai Healthcare System**  
*Powered by Go, PostgreSQL, and Docker*

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô

### 1. Clone Repository
```bash
git clone https://github.com/chisanucha-plum/hospital-api.git
cd hospital-api
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
```bash
# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå environment template
cp .env.example .env

# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏ô .env ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
```

### 3. ‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Docker Compose (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
```bash
# Build ‡πÅ‡∏•‡∏∞ start ‡∏ó‡∏∏‡∏Å service
docker-compose up --build

# ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡πÉ‡∏ô background
docker-compose up -d --build

# ‡∏´‡∏¢‡∏∏‡∏î service
docker-compose down
```

### 4. ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö Local Development (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Docker)
```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
go mod download

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ PostgreSQL local ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç .env
# DB_HOST=localhost
# DB_PORT=5432

# ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°
go run cmd/main.go
```

## API Endpoints

### üîê Staff Authentication

#### ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
```
POST /staff/create
Content-Type: application/json

{
  "username": "admin123",
  "password": "securepassword",
  "hospital_id": 1
}
```

#### ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
```
POST /staff/login
Content-Type: application/json

{
  "username": "admin123",
  "password": "securepassword"
}
```
**Response:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### üè• Patient Management (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ JWT)

#### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ ID
```
GET /patient/search/{national_id}
Authorization: Bearer {JWT_TOKEN}
```
**Response:**
```json
{
  "national_id": "1234567890123",
  "patient_hn": "HN0001",
  "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
  "middle_name_th": "",
  "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ",
  "first_name_en": "Somchai",
  "middle_name_en": "",
  "last_name_en": "Jaidee",
  "date_of_birth": "1990-01-01T00:00:00Z",
  "passport_id": "",
  "phone_number": "0812345678",
  "email": "somchai@example.com",
  "gender": "M",
  "hospital_id": 1
}
```

#### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö Multi-field (OR Search)
```
POST /patient/search
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

{
  "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
  "phone_number": "0812345678",
  "patient_hn": "HN0001"
}
```
**Response:**
```json
[
  {
    "national_id": "1234567890123",
    "patient_hn": "HN0001",
    "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
    "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ",
    // ... other fields
  }
]
```

#### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö JSON Body (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á GET ‡πÅ‡∏•‡∏∞ POST)
```
GET /patient/search
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

{
  "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
  "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ"
}
```
**Response:**
```json
{
  "success": true,
  "message": "Patients found",
  "data": {
    "count": 1,
    "patients": [
      {
        "national_id": "1234567890123",
        "patient_hn": "HN0001",
        "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
        "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ",
        "first_name_en": "Somchai",
        "last_name_en": "Jaidee",
        "date_of_birth": "1990-01-01T00:00:00+07:00",
        "gender": "M",
        "hospital_id": "1"
      }
    ]
  }
}
```

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

#### 1. ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
```bash
curl -X POST "http://localhost:8081/staff/create" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin123",
    "password": "mypassword",
    "hospital_id": 1
  }'
```

#### 2. ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö JWT Token
```bash
curl -X POST "http://localhost:8081/staff/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin123",
    "password": "mypassword"
  }'
```

#### 3. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ National ID
```bash
curl -X GET "http://localhost:8081/patient/search/1234567890123" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE"
```

#### 4. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö Multi-field
```bash
curl -X POST "http://localhost:8081/patient/search" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢"
  }'
```

#### 5. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ JSON Body (GET)
```bash
curl -X GET "http://localhost:8002/patient/search" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "first_name_th": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
    "last_name_th": "‡πÉ‡∏à‡∏î‡∏µ"
  }'
```

## Environment Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `PORT` | API server port | 8002 | No |
| `DB_HOST` | Database host | localhost | Yes |
| `DB_PORT` | Database port | 5432 | Yes |
| `DB_USER` | Database username | - | Yes |
| `DB_PASSWORD` | Database password | - | Yes |
| `DB_NAME` | Database name | - | Yes |
| `JWT_SECRET` | JWT signing secret | - | Yes |

## Database Schema

### ERD (Entity Relationship Diagram)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Hospital  ‚îÇ       ‚îÇ    Staff    ‚îÇ       ‚îÇ   Patient   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îå‚îÄ‚îÄ‚Üí‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îå‚îÄ‚îÄ‚Üí‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (PK)     ‚îÇ   ‚îÇ   ‚îÇ id (PK)     ‚îÇ   ‚îÇ   ‚îÇ national_id ‚îÇ
‚îÇ name        ‚îÇ   ‚îÇ   ‚îÇ username    ‚îÇ   ‚îÇ   ‚îÇ patient_hn  ‚îÇ
‚îÇ created_at  ‚îÇ   ‚îÇ   ‚îÇ password    ‚îÇ   ‚îÇ   ‚îÇ first_name  ‚îÇ
‚îÇ updated_at  ‚îÇ   ‚îÇ   ‚îÇ hospital_id ‚îÇ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ last_name   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ created_at  ‚îÇ       ‚îÇ hospital_id ‚îÇ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ   ‚îÇ updated_at  ‚îÇ       ‚îÇ gender      ‚îÇ
                  ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ created_at  ‚îÇ
                  ‚îÇ                         ‚îÇ updated_at  ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Relationships
- `Hospital` ‚Üí `Staff` (One-to-Many)
- `Hospital` ‚Üí `Patient` (One-to-Many)  
- `Staff.hospital_id` ‡πÅ‡∏•‡∏∞ `Patient.hospital_id` ‡πÄ‡∏õ‡πá‡∏ô Foreign Keys

## ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤

### ‡∏£‡∏±‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î Development
```bash
# ‡∏î‡πâ‡∏ß‡∏¢ Docker Compose (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
docker-compose up --build

# ‡∏´‡∏£‡∏∑‡∏≠ local development
go run cmd/main.go

# ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á air ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö auto-reload
air
```

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
```bash
# ‡∏£‡∏±‡∏ô unit tests ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
go test ./...

# ‡∏£‡∏±‡∏ô test ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ package
go test ./internal/services/
go test ./internal/router/

# ‡∏£‡∏±‡∏ô test ‡∏û‡∏£‡πâ‡∏≠‡∏° coverage
go test -cover ./...
```

### Build Production
```bash
# Build binary
go build -o bin/hospital-api cmd/main.go

# ‡∏´‡∏£‡∏∑‡∏≠ build Docker image
docker build -t hospital-api .
```

## Docker Deployment

### Development
```bash
docker-compose up --build
```

### Production
```bash
# Build production image
docker build -t hospital-api:latest .

# Run with custom env
docker run -d \
  --name hospital-api \
  -p 8002:8002 \
  --env-file .env \
  hospital-api:latest
```

## Security & Best Practices

### üîê Security Features
- **JWT Authentication** - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï
- **bcrypt Password Hashing** - ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
- **Foreign Key Constraints** - ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- **Input Validation** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

### üìã Production Checklist
- [ ] ‡πÉ‡∏ä‡πâ HTTPS/TLS ‡πÉ‡∏ô production
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ CORS ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
- [ ] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô JWT_SECRET ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á
- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ rate limiting
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° logging ‡πÅ‡∏•‡∏∞ monitoring
- [ ] Backup database ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥

## Contributing

### Code Style
- ‡πÉ‡∏ä‡πâ `gofmt` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö formatting
- ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö camelCase
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô unit tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô comment ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö business logic

### Pull Request Process
1. Fork repository ‡∏ô‡∏µ‡πâ
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á feature branch (`git checkout -b feature/amazing-feature`)
3. Commit ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (`git commit -m 'Add amazing feature'`)
4. Push ‡πÑ‡∏õ‡∏¢‡∏±‡∏á branch (`git push origin feature/amazing-feature`)
5. ‡πÄ‡∏õ‡∏¥‡∏î Pull Request

## Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

#### 1. "Connection refused" - ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ database
```bash
# ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ PostgreSQL ‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
docker-compose ps

# restart database service
docker-compose restart postgres_server
```

#### 2. "Foreign key constraint" error
```bash
# ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞ migrate ‡πÉ‡∏´‡∏°‡πà
docker-compose down -v
docker-compose up --build
```

#### 3. "JWT token invalid"
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ JWT_SECRET ‡πÉ‡∏ô .env ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ token ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)

## Performance & Monitoring

### Metrics ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°
- Response time per endpoint
- Database connection pool usage
- Memory ‡πÅ‡∏•‡∏∞ CPU usage
- Error rate ‡πÅ‡∏•‡∏∞ logs

### Scaling Recommendations
- ‡πÉ‡∏ä‡πâ Database connection pooling
- ‡πÄ‡∏û‡∏¥‡πà‡∏° Redis ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö caching
- Load balancer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö multiple instances
- Database indexing ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö search queries

## License
Copyright ¬© 2025 Hospital API Management System  
All rights reserved.

## Contact
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
- GitHub Issues: [Create an issue](https://github.com/chisanucha-plum/hospital-api/issues)
- Email: support@hospital-api.com

---
**Made with ‚ù§Ô∏è for Thai Healthcare System**
